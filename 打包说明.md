# 应用程序打包说明

本说明介绍如何将广告数据分析系统打包成可在Windows和Mac上独立运行的应用程序。

## 打包方式

### 方式一：使用 GitHub Actions 自动打包（推荐）

**无需本地环境，自动打包 Windows 和 Mac 版本！**

详细说明请查看：[.github/workflows/README.md](.github/workflows/README.md)

**快速开始：**
1. 将代码推送到 GitHub 仓库
2. 创建标签并推送：`git tag v1.0.0 && git push origin v1.0.0`
3. 在 GitHub Actions 页面下载打包好的应用

### 方式二：本地打包

## 本地打包要求

- Python 3.7 或更高版本
- 已安装所有依赖包（运行 `pip install -r requirements.txt`）

## Windows 打包步骤

1. **打开命令提示符（CMD）或PowerShell**
   - 在项目目录下打开终端

2. **运行打包脚本**
   ```bash
   build_windows.bat
   ```

3. **等待打包完成**
   - 打包过程可能需要几分钟
   - 完成后会在 `dist` 目录下生成 `广告数据分析系统.exe`

4. **使用打包后的应用**
   - 将 `dist\广告数据分析系统.exe` 复制到任何Windows电脑
   - 双击运行即可，无需安装Python
   - 运行后会自动打开浏览器访问系统

## Mac 打包步骤

1. **打开终端（Terminal）**
   - 在项目目录下打开终端

2. **运行打包脚本**
   ```bash
   ./build_mac.sh
   ```

3. **等待打包完成**
   - 打包过程可能需要几分钟
   - 完成后会在 `dist` 目录下生成 `广告数据分析系统`

4. **使用打包后的应用**
   - 将 `dist/广告数据分析系统` 复制到任何Mac电脑
   - 双击运行即可，无需安装Python
   - 如果提示"无法打开，因为无法验证开发者"：
     - 右键点击应用程序
     - 选择"打开"
     - 在弹出对话框中点击"打开"
   - 运行后会自动打开浏览器访问系统

## 打包后的文件结构

打包后的应用程序包含：
- 所有Python代码和依赖库
- 前端资源（HTML、CSS、JavaScript）
- 模板文件
- 所有必要的Python包

## 使用说明

1. **启动应用**
   - Windows: 双击 `广告数据分析系统.exe`
   - Mac: 双击 `广告数据分析系统`
   - 会打开一个控制台窗口显示运行状态

2. **访问系统**
   - 应用启动后会自动打开浏览器
   - 如果没有自动打开，请访问控制台显示的地址（通常是 http://127.0.0.1:5000）

3. **关闭应用**
   - 关闭控制台窗口即可停止服务
   - 或按 Ctrl+C（Windows）或 Cmd+C（Mac）

## 注意事项

1. **首次运行**
   - 首次运行可能需要几秒钟启动时间
   - 杀毒软件可能会提示，请选择"允许"或"信任"

2. **端口占用**
   - 如果5000端口被占用，应用会自动使用其他端口（5001-5099）
   - 请查看控制台窗口显示的访问地址

3. **数据存储**
   - 上传的文件和处理后的数据会保存在系统临时目录中
   - Windows: 通常在 `C:\Users\<用户名>\AppData\Local\Temp\huawei_dashboard_*`
   - Mac: 通常在 `/var/folders/.../huawei_dashboard_*`
   - 这些文件夹会自动创建和管理，无需手动处理

4. **文件大小**
   - 打包后的应用文件较大（约100-200MB），因为包含了所有依赖
   - 这是正常现象，确保应用可以独立运行

5. **性能**
   - 打包后的应用启动速度可能比直接运行Python脚本稍慢
   - 运行性能与直接运行Python脚本相同

## 故障排除

### Windows

**问题：提示"找不到Python"**
- 解决：确保已安装Python 3.7+，并添加到系统PATH

**问题：打包失败**
- 解决：检查是否有杀毒软件阻止，尝试以管理员身份运行

**问题：运行后无法访问**
- 解决：检查防火墙设置，确保允许应用访问网络

### Mac

**问题：提示"无法打开，因为无法验证开发者"**
- 解决：右键点击应用，选择"打开"，然后在对话框中点击"打开"

**问题：打包失败**
- 解决：确保有足够的磁盘空间（至少500MB）

**问题：运行后无法访问**
- 解决：检查系统偏好设置 > 安全性与隐私，允许应用运行

## 高级选项

### 自定义图标

1. 准备图标文件：
   - Windows: `.ico` 格式
   - Mac: `.icns` 格式

2. 修改 `build_app.spec` 文件：
   ```python
   icon='path/to/your/icon.ico'  # Windows
   icon='path/to/your/icon.icns'  # Mac
   ```

3. 重新打包

### 隐藏控制台窗口（仅Windows）

修改 `build_app.spec` 文件：
```python
console=False,  # 改为False
```

注意：隐藏控制台后无法看到运行状态和错误信息，建议保留控制台。

### 单文件模式 vs 文件夹模式

当前配置为单文件模式（一个exe文件），如果需要文件夹模式（多个文件），可以修改 `build_app.spec` 中的配置。

## 技术支持

如果遇到问题，请检查：
1. Python版本是否符合要求（3.7+）
2. 所有依赖包是否正确安装
3. 是否有足够的磁盘空间
4. 查看控制台窗口的错误信息

